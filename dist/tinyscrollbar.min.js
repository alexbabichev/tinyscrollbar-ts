"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var i,e=1,s=arguments.length;e<s;e++)for(var o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var wheelEvent="wheel",pluginName="tinyscrollbar",touchLabel=Symbol(pluginName+"Touch"),defaults={axis:"y",wheel:!0,wheelSpeed:40,wheelLock:!0,touchLock:!0,trackSize:!1,thumbSize:!1,thumbSizeMin:20},Tinyscrollbar=function(){function t(t,i){this.$body=document.querySelectorAll("body")[0],this.mousePosition=0,this.contentPosition=0,this.viewportSize=0,this.contentSize=0,this.contentRatio=0,this.trackSize=0,this.trackRatio=0,this.thumbSize=0,this.thumbPosition=0,this.hasContentToScroll=!1,this.options=__assign({},defaults,i),this.$container=t,this.$viewport=t.querySelectorAll(".viewport")[0],this.$overview=t.querySelectorAll(".overview")[0],this.$scrollbar=t.querySelectorAll(".scrollbar")[0],this.$track=this.$scrollbar.querySelectorAll(".track")[0],this.$thumb=this.$scrollbar.querySelectorAll(".thumb")[0],this.hasTouchEvents="ontouchstart"in document.documentElement,this.isHorizontal="x"===this.options.axis,this.sizeLabel=this.isHorizontal?"width":"height",this.posiLabel=this.isHorizontal?"left":"top",this.moveEvent=document.createEvent("HTMLEvents"),this.moveEvent.initEvent("move",!0,!0),this.update(),this.setEvents()}return t.prototype.update=function(t){void 0===t&&(t=0);var i=this.sizeLabel.charAt(0).toUpperCase()+this.sizeLabel.slice(1).toLowerCase(),e=this.$scrollbar.className,s=Number(this.options.trackSize),o=Math.max(this.options.thumbSizeMin,s||this.trackSize*this.contentRatio);switch(this.viewportSize=this.$viewport["offset"+i],this.contentSize=this.$overview["scroll"+i],this.contentRatio=this.viewportSize/this.contentSize,this.trackSize=s||this.viewportSize,this.thumbSize=Math.min(this.trackSize,o),this.trackRatio=(this.contentSize-this.viewportSize)/(this.trackSize-this.thumbSize),this.hasContentToScroll=this.contentRatio<1,this.$scrollbar.className=this.hasContentToScroll?e.replace(/disable/g,""):e.replace(/ disable/g,"")+" disable",t){case"bottom":this.contentPosition=Math.max(this.contentSize-this.viewportSize,0);break;case"relative":var n=Math.max(this.contentSize-this.viewportSize,0);this.contentPosition=Math.min(n,Math.max(0,this.contentPosition));break;default:this.contentPosition=parseInt(t.toString(),10)||0}this.thumbPosition=this.contentPosition/this.trackRatio,this.setCss()},t.prototype.setStyleAttribute=function(i,e){void 0!==e&&Object.keys(e).forEach(function(t){i.style.setProperty(t,e[t])})},t.prototype.setCss=function(){var t,i,e,s,o;this.setStyleAttribute(this.$thumb,((t={})[this.posiLabel]=this.thumbPosition+"px",t)),this.setStyleAttribute(this.$overview,((i={})[this.posiLabel]=this.contentPosition+"px",i)),this.setStyleAttribute(this.$scrollbar,((e={})[this.sizeLabel]=this.trackSize+"px",e)),this.setStyleAttribute(this.$track,((s={})[this.sizeLabel]=this.trackSize+"px",s)),this.setStyleAttribute(this.$thumb,((o={})[this.sizeLabel]=this.thumbSize+"px",o))},t.prototype.setEvents=function(){var e=this;this.hasTouchEvents&&(this.$viewport.ontouchstart=function(t){if(1===t.touches.length){var i=t.touches[0];e.start(i,!1),t.stopPropagation()}}),this.$thumb.onmousedown=function(t){t.stopPropagation(),e.start(t,!1)},this.$track.onmousedown=function(t){e.start(t,!0)},window.addEventListener("resize",function(){e.update("relative")},!0),this.$container.addEventListener(wheelEvent,function(t){e.wheel(t)},!1),this.update("relative")},t.prototype.isAtBegin=function(){return 0<this.contentPosition},t.prototype.isAtEnd=function(){return this.contentPosition<=this.contentSize-this.viewportSize-5},t.prototype.start=function(t,i){var e=this;if(this.hasContentToScroll){var s=this.posiLabel;this.mousePosition=i?this.$thumb.getBoundingClientRect()[s]:this.isHorizontal?t.clientX:t.clientY,this.$body.className+=" noSelect",this.hasTouchEvents&&(document.ontouchmove=function(t){(e.options.touchLock||e.isAtBegin()&&e.isAtEnd())&&t.preventDefault();var i=t.touches[0];i[touchLabel]=1,e.drag(i),document.ontouchend=e.end.bind(e)}),document.onmouseup=this.$thumb.onmouseup=this.end.bind(this),document.onmousemove=function(t){e.drag(t)},this.drag(t)}},t.prototype.wheel=function(t){var i,e;if(this.hasContentToScroll){var s=t||window.event,o=-(s.deltaY||s.detail||-1/3*s.wheelDelta)/40;this.contentPosition-=o*this.options.wheelSpeed,this.contentPosition=Math.min(this.contentSize-this.viewportSize,Math.max(0,this.contentPosition)),this.thumbPosition=this.contentPosition/this.trackRatio,this.$container.dispatchEvent(this.moveEvent),this.setStyleAttribute(this.$thumb,((i={})[this.posiLabel]=this.thumbPosition+"px",i)),this.setStyleAttribute(this.$overview,((e={})[this.posiLabel]=-this.contentPosition+"px",e)),(this.options.wheelLock||this.isAtBegin()&&this.isAtEnd())&&s.preventDefault(),t.stopPropagation()}},t.prototype.drag=function(t){var i,e;if(this.hasContentToScroll){var s=this.isHorizontal?t.clientX:t.clientY,o=t[touchLabel]?this.mousePosition-s:s-this.mousePosition,n=Math.max(0,this.thumbPosition+o),h=Math.min(this.trackSize-this.thumbSize,n);this.contentPosition=h*this.trackRatio,this.$container.dispatchEvent(this.moveEvent),this.setStyleAttribute(this.$thumb,((i={})[this.posiLabel]=h+"px",i)),this.setStyleAttribute(this.$overview,((e={})[this.posiLabel]=-this.contentPosition+"px",e))}},t.prototype.end=function(){var t=this.posiLabel;this.thumbPosition=parseInt(this.$thumb.style[t],10)||0,this.$body.className=this.$body.className.replace(" noSelect",""),this.$thumb.onmouseup=null,this.$track.onmouseup=null,document.ontouchmove=document.ontouchend=null,document.onmousemove=document.onmouseup=null},t}();exports.default=Tinyscrollbar;